---
title: "CS 422 Section 04"
output: 
 html_notebook:
   toc: yes
   toc_float: yes
author: Ruchi Sharma
---

## Problem 2.1
# Problem 2.1 (a)
```{r}
setwd("C:/Users/Ruchi Awasthi/Desktop/Masters/DM/Assignment 1")
college.df = read.csv("College.csv", header=TRUE, ",")
head(college.df, 6)
```

#  Problem 2.1 (b) 
```{r}
data <- table(college.df$Private)
print(data)
```

#  Problem 2.1 (C) 
```{r}
xname <- "PhD Holder"
public.df <- dplyr::filter(college.df, Private== "No")
private.df <- dplyr::filter(college.df, Private== "Yes")
hist(public.df$PhD, xlab=xname, main = paste("Histogram of PhD Holder in Public College"), col="yellow", border="blue",  freq = FALSE)
lines(density(public.df$PhD),col="red")
hist(private.df$PhD, xlab=xname,  main = paste("Histogram of PhD Holder in Private College"), col="yellow", border="blue", freq = FALSE)
lines(density(private.df$PhD),col="red")
```
#SO in 2.1 (C) by seeing the histogram i can comment that private colleges are top heavy with respect to PhD faculty

#  Problem 2.1 (d)
```{r}
sorted_college.df <- dplyr::arrange(college.df, Grad.Rate)
dplyr::select(head (sorted_college.df,n=5),Name,Grad.Rate )
dplyr::select(tail (sorted_college.df, n=5),Name,Grad.Rate)
```

#  Problem 2.1 (e) i
```{r}
summary(college.df)
```

#  Problem 2.1 (e) ii
```{r}
pairs(college.df[, 1:10])
```

#  Problem 2.1 (e) iii
```{r}
boxplot(perc.alumni~Private, data=college.df, main="Percentage Contribution OF Alumni", 
  	xlab="Type of Colleges", ylab="Alumni Contribution Percentage", col =c("green", "blue"))
```
# So In 2.1 (e) iii: The alumni who go to private college donate more

#  Problem 2.1 (e) iV
```{r}
boxplot(PhD~Private, data=college.df, main="Contribution OF Alumni", 
  	xlab="Type of Colleges", ylab="Donation By Alumni", col =c("green", "blue"))
```
# So In 2.1 (e)iV : Private colleges employ more PhD 

#  Problem 2.1 (e) v
```{r}
Elite <- rep("No", nrow(college.df))
Elite[college.df$Top10perc > 50] <- "Yes"
Elite <- as.factor(Elite)
college.df <- data.frame(college.df, Elite)
summary(college.df$Elite)
```

#  Problem 2.1 (e) vi
```{r}
par(mfrow=c(2,2))
hist(college.df$Top10perc, breaks=5)
hist(college.df$Top10perc, breaks=10)
hist(college.df$Top10perc, breaks=20)
hist(college.df$Top10perc, breaks=40)
```

#  Problem 2.1 (e) vii
```{r}
print("From observation we find that priavte college employ more PhD people,
      There is a college Albertson College, which takes more number of applications.")
```

##Poblem 2.2

#Problem 2.2 (a) i
```{r}
setwd("C:/Users/Ruchi Awasthi/Desktop/Masters/DM/Assignment 1")
auto.df = read.csv("auto-mpg.csv", header=TRUE, ",")
which(auto.df$horsepower=="?")
auto.df <- auto.df [-c(33,127,331,337,355,375)]
```

#Problem 2.2 (a) ii
```{r}
str(auto.df)
auto.df$horsepower <- as.integer(auto.df$horsepower)
str(auto.df)
```

#Problem 2.2 (b) 
```{r}
psych::pairs.panels(auto.df)
model <- lm(mpg ~ weight, data=auto.df)
summary(model)
RSS_Value <- c(crossprod(model$residuals))
MSE_Value <- RSS_Value/ length(model$residuals)
RMSE_Value <- sqrt(MSE_Value)
print(RMSE_Value)
```

#Problem 2.2 (c) 
```{r}
plot(model)
```

#Problem 2.2 (d) i
```{r}
set.seed(1122)
index <- sample(1:nrow(auto.df), 0.80*dim(auto.df)[1])
train.df <- auto.df[index, ]
test.df <- auto.df[-index, ]
model1 <- lm(mpg ~ .-car.name, data=train.df)
print ("Car name is an independent variable, it would not help us to get any mpg")
```

#Problem 2.2 (d) ii
```{r}
summary(model)
RSS_Val <- c(crossprod(model1$residuals))
MSE_Val <- RSS_Value/ length(model1$residuals)
RMSE_Val <- sqrt(MSE_Value)
print (RMSE_Val)
```

#Problem 2.2 (e) i
```{r}
library(leaps)
best.model <- regsubsets(mpg~ . -car.name, auto.df, nvmax=3, really.big	= TRUE)
mod <- lm(mpg ~ weight + model.year+ origin  , data=auto.df)
```

#Problem 2.2 (e) ii
```{r}
summary (mod)
RSS <- c(crossprod(mod$residuals))
MSE <- RSS/ length(mod$residuals)
RMSE <- sqrt(MSE)
print (RMSE)
```

#Problem 2.2 (f)
```{r}
plot(mod$residuals)
```
#Problem 2.2 (g)
```{r}
hist(mod$residuals, ylab="Residuals", col="yellow", border="blue", freq = FALSE)
print("No, It does not follow Gaussian distribution. It is just a Normal distribution")
```

#Problem 2.2 (h)
```{r}
Pred <- predict(mod, test.df)
actuals_preds <- data.frame(cbind(actuals=test.df$mpg, predicteds=Pred)) 
actuals_preds$mpg <- test.df$mpg
actuals_preds
equality <-actuals_preds$mpg[actuals_preds$predicted == actuals_preds$mpg]
equality
```
#Problem 2.2 (i)
```{r}
err <- actuals_preds$predicted - actuals_preds$mpg
error <- err^2
totalerror <- actuals_preds$mpg - mean(actuals_preds$mpg)

#1.
rss <- sum(error)
print( rss)
#2
tss <- sum(totalerror^2)
print(tss)
#3
Fstat <- ((tss-rss)/3)/(rss/nrow(actuals_preds)-3-1)
print(Fstat)
#4
rse<- sqrt(sum(error)/length(error))
print(rse)
#RMSE
rmse <- sqrt(mean(error))
print(rmse)

```
 
